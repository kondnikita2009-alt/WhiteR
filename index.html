<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StudyBox ‚Äî –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@500;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. GLOBAL THEME & TYPOGRAPHY --- */
        :root {
            /* Colors */
            --bg-body: #ffffff;
            --bg-surface: #f8f9fc;
            
            --text-primary: #111827;
            --text-secondary: #4B5563;
            --text-tertiary: #9CA3AF;
            
            --primary-gradient: linear-gradient(135deg, #7F00FF 0%, #E100FF 100%);
            --primary-color: #7F00FF;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-blur: blur(20px);
            
            /* Shadows & Effects */
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(127, 0, 255, 0.15);
            --glow: 0 0 20px rgba(127, 0, 255, 0.4);
            
            /* Animation Curves */
            --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }

        h1, h2, h3, h4, .brand-font {
            font-family: 'Outfit', sans-serif;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        /* –ú–∞–≥–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç (–ì—Ä–∞–¥–∏–µ–Ω—Ç) */
        .text-gradient {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }

        /* --- 2. LOADING SCREEN (SPLASH) --- */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease, visibility 0.8s;
        }

        .splash-logo {
            font-size: 3.5rem;
            font-weight: 800;
            opacity: 0;
            transform: scale(0.9);
            animation: splashEntry 2s var(--ease-smooth) forwards;
        }

        @keyframes splashEntry {
            0% { opacity: 0; transform: scale(0.9) translateY(20px); }
            50% { opacity: 1; transform: scale(1); }
            80% { opacity: 1; transform: scale(1); filter: blur(0px); }
            100% { opacity: 0; transform: scale(1.1); filter: blur(10px); }
        }

        /* --- 3. HEADER & NAV --- */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.0);
            backdrop-filter: blur(0px);
        }

        header.scrolled {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .burger-btn {
            position: absolute;
            left: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .burger-btn:hover { background: rgba(0,0,0,0.05); }

        .burger-line {
            width: 20px;
            height: 2px;
            background: var(--text-primary);
            border-radius: 2px;
            transition: all 0.4s var(--ease-elastic);
        }

        /* Burger Active State */
        .burger-btn.active .burger-line:nth-child(1) { transform: rotate(45deg) translate(5px, 6px); width: 22px; }
        .burger-btn.active .burger-line:nth-child(2) { transform: scale(0); }
        .burger-btn.active .burger-line:nth-child(3) { transform: rotate(-45deg) translate(5px, -6px); width: 22px; }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        /* Fullscreen Menu */
        .nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--bg-body);
            z-index: 999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
            transition: all 0.5s var(--ease-smooth);
        }

        .nav-overlay.active {
            opacity: 1;
            pointer-events: all;
            transform: scale(1);
        }

        .nav-link {
            font-family: 'Outfit', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-tertiary); /* Inactive color */
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .nav-link.current {
            color: var(--text-primary);
        }
        
        .nav-link:hover {
            color: var(--primary-color);
            transform: translateX(10px);
        }

        /* --- 4. MAIN LAYOUT --- */
        main {
            padding-top: 80px;
            min-height: 100vh;
        }

        section {
            display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏, JS –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        section.active {
            display: block;
        }
        section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- HOME SECTION DESIGN --- */
        .hero-container {
            text-align: center;
            padding: 60px 20px;
        }

        .badge-new {
            display: inline-block;
            padding: 6px 16px;
            background: rgba(127, 0, 255, 0.1);
            color: var(--primary-color);
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 24px;
            border: 1px solid rgba(127, 0, 255, 0.2);
        }

        .hero-title {
            font-size: 3.5rem;
            margin-bottom: 24px;
        }
        
        @media(max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
        }

        .hero-desc {
            font-size: 1.15rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 48px auto;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .info-card {
            background: #fff;
            padding: 32px;
            border-radius: 24px;
            text-align: left;
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 4px; height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .info-card:hover::before { opacity: 1; }

        .card-icon {
            width: 50px;
            height: 50px;
            background: var(--bg-surface);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .card-title { font-size: 1.25rem; margin-bottom: 12px; }
        .card-text { color: var(--text-secondary); font-size: 0.95rem; }

        /* --- SOLUTIONS WIZARD DESIGN --- */
        .wizard-wrapper {
            background: #fff;
            border-radius: 30px;
            box-shadow: var(--shadow-lg);
            padding: 40px;
            margin-top: 20px;
            border: 1px solid rgba(0,0,0,0.04);
        }

        .progress-bar {
            display: flex;
            margin-bottom: 40px;
            position: relative;
        }
        .progress-line {
            position: absolute;
            top: 50%; left: 0; width: 100%; height: 2px;
            background: #eee; z-index: 1;
            transform: translateY(-50%);
        }
        .progress-fill {
            position: absolute;
            top: 50%; left: 0; height: 2px;
            background: var(--primary-color); z-index: 1;
            transform: translateY(-50%);
            width: 0%; /* JS will animate this */
            transition: width 0.4s ease;
        }
        .step-node {
            width: 40px; height: 40px;
            background: #fff;
            border: 2px solid #eee;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            font-weight: 600;
            color: #ccc;
            margin: 0 auto; /* –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ flex */
            transition: all 0.3s;
        }
        .progress-bar div { flex: 1; text-align: center; }
        
        .step-node.active {
            border-color: var(--primary-color);
            color: var(--primary-color);
            box-shadow: 0 0 15px rgba(127, 0, 255, 0.2);
        }
        .step-node.completed {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* Form Inputs Styling */
        .modern-select, .modern-input {
            width: 100%;
            padding: 18px 20px;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: var(--text-primary);
            background: var(--bg-surface);
            border: 1px solid transparent;
            border-radius: 16px;
            margin-bottom: 20px;
            transition: all 0.3s;
            appearance: none; /* –£–±–∏—Ä–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–µ–ª–∫—É */
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234B5563' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 20px center;
            background-size: 16px;
        }
        
        .modern-input { background-image: none; } /* –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É –¥–ª—è input */

        .modern-select:focus, .modern-input:focus {
            outline: none;
            background: #fff;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(127, 0, 255, 0.1);
        }

        .btn-magic {
            width: 100%;
            padding: 18px;
            background: var(--primary-gradient);
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            box-shadow: 0 10px 20px -5px rgba(127, 0, 255, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn-magic:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px -5px rgba(127, 0, 255, 0.5);
        }
        .btn-magic:active { transform: scale(0.98); }

    </style>
</head>
<body>

    <div id="splash-screen">
        <h1 class="splash-logo text-gradient">StudyBox</h1>
    </div>

    <header id="app-header">
        <div class="burger-btn" onclick="toggleMenu()">
            <span class="burger-line"></span>
            <span class="burger-line"></span>
            <span class="burger-line"></span>
        </div>
        <div class="logo brand-font text-gradient">StudyBox</div>
    </header>

    <div class="nav-overlay" id="nav-overlay">
        <a class="nav-link current" onclick="navigateTo('home')">–ì–ª–∞–≤–Ω–∞—è</a>
        <a class="nav-link" onclick="navigateTo('solutions')">–†–µ—à–µ–Ω–∏—è</a>
        <a class="nav-link" style="color: var(--primary-color);" onclick="openAI()">StudyBox AI ‚ú®</a>
    </div>

    <main>
        <section id="home" class="active">
            <div class="hero-container">
                <div class="fade-in-element">
                    <span class="badge-new">–í–µ—Ä—Å–∏—è 2.0 (Beta)</span>
                    <h2 class="hero-title">–£–º–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ <br><span class="text-gradient">–±–µ–∑ –≥—Ä–∞–Ω–∏—Ü</span></h2>
                    <p class="hero-desc">
                        StudyBox ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ì–î–ó. –≠—Ç–æ —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç –ø–æ–Ω–∏–º–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª. –í–∏–¥–µ–æ—Ä–∞–∑–±–æ—Ä—ã, –ø–æ—à–∞–≥–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ AI-—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
                    </p>
                </div>

                <div class="cards-grid">
                    <div class="info-card fade-in-element" style="transition-delay: 0.1s;">
                        <div class="card-icon">üéì</div>
                        <h3 class="card-title">–ß–µ—Å—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
                        <p class="card-text">–ú—ã —Å–∫—Ä—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —Ç—ã –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–∏—à—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ. –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–∞—É—á–∏—Ç—å.</p>
                    </div>
                    <div class="info-card fade-in-element" style="transition-delay: 0.2s;">
                        <div class="card-icon">‚ö°</div>
                        <h3 class="card-title">–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π AI</h3>
                        <p class="card-text">–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á—É –ø–æ —Ñ–æ—Ç–æ –∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É —Ä–µ—à–µ–Ω–∏—è.</p>
                    </div>
                    <div class="info-card fade-in-element" style="transition-delay: 0.3s;">
                        <div class="card-icon">üìπ</div>
                        <h3 class="card-title">–í–∏–¥–µ–æ—Ñ–æ—Ä–º–∞—Ç</h3>
                        <p class="card-text">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç —Ä–∞–∑–±–æ—Ä—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∏–∑ —É—á–µ–±–Ω–∏–∫–æ–≤.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="solutions">
            <div class="hero-container">
                <h2 class="hero-title">–ü–æ–∏—Å–∫ <span class="text-gradient">–†–µ—à–µ–Ω–∏—è</span></h2>
                
                <div class="wizard-wrapper">
                    <div class="progress-bar">
                        <div class="progress-line"></div>
                        <div class="progress-fill" id="progress-fill"></div>
                        <div><div class="step-node active" id="node-1">1</div></div>
                        <div><div class="step-node" id="node-2">2</div></div>
                        <div><div class="step-node" id="node-3">3</div></div>
                        <div><div class="step-node" id="node-4">4</div></div>
                    </div>

                    <div id="wizard-step-1" class="wizard-step">
                        <h3 style="margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –æ–±—É—á–µ–Ω–∏—è</h3>
                        <select class="modern-select" id="select-class" onchange="wizNext(1)">
                            <option value="" disabled selected>–£–∫–∞–∂–∏—Ç–µ –∫–ª–∞—Å—Å</option>
                            <option value="9">9 –ö–ª–∞—Å—Å</option>
                            <option value="10">10 –ö–ª–∞—Å—Å</option>
                            <option value="11">11 –ö–ª–∞—Å—Å</option>
                        </select>
                    </div>
                    
                    <div id="wizard-dynamic-container"></div>
                </div>
            </div>
        </section>
    </main>
    <div class="ai-sheet-overlay" id="ai-overlay" onclick="closeAI()"></div>
    <div class="ai-sheet" id="ai-sheet">
        <div class="ai-sheet-header">
            <div class="ai-drag-handle"></div>
            <div class="ai-header-content">
                <div class="ai-avatar">‚ú®</div>
                <div>
                    <h3 class="brand-font" style="font-size: 1.1rem;">StudyBox AI</h3>
                    <p style="font-size: 0.75rem; color: #10b981;">‚Ä¢ –û–Ω–ª–∞–π–Ω | –¢–≤–æ–π —É–º–Ω—ã–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä</p>
                </div>
                <button class="ai-close-btn" onclick="closeAI()">√ó</button>
            </div>
        </div>

        <div class="ai-chat-body" id="ai-chat-body">
            <div class="chat-welcome">
                <div class="magic-loader"></div>
                <h4>–ú–∞–≥–∏—è –∑–∞–≥—Ä—É–∑–∫–∏...</h4>
                <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –ø—Ä–æ—à–ª—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≥–æ—Ç–æ–≤–ª—é—Å—å –ø–æ–º–æ–≥–∞—Ç—å!</p>
            </div>
        </div>

        <div class="ai-chat-footer">
            <div class="ai-input-wrapper">
                <textarea id="ai-input" placeholder="–°–ø—Ä–æ—Å–∏ –æ —á–µ–º —É–≥–æ–¥–Ω–æ..." rows="1"></textarea>
                <button id="ai-send-btn" onclick="sendAIMessage()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
                </button>
            </div>
        </div>
    </div>

    <section id="admin">
        <div class="admin-container">
            <div class="admin-header">
                <h2 class="brand-font">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è <span class="text-gradient">v2.0</span></h2>
                <button class="btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>

            <div class="admin-grid">
                <div class="admin-card">
                    <h3>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤</h3>
                    <div class="admin-control-item">
                        <span>–ó–∞–≥–æ–ª–æ–≤–æ–∫ Hero</span>
                        <input type="text" id="conf-hero-title" class="modern-input" value="–£–º–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü">
                    </div>
                    <div class="admin-control-item">
                        <span>–û—Å–Ω–æ–≤–Ω–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç (CSS)</span>
                        <input type="text" id="conf-gradient" class="modern-input" value="linear-gradient(135deg, #7F00FF 0%, #E100FF 100%)">
                    </div>
                    <button class="btn-magic" style="padding: 12px;" onclick="saveConfig()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </div>

                <div class="admin-card">
                    <h3>–ë–∞–∑–∞ —Ä–µ—à–µ–Ω–∏–π (–ì–î–ó)</h3>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 15px;">–î–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ –∏ –∑–∞–¥–∞—á–∏</p>
                    <button class="btn-magic" style="background: var(--text-primary); padding: 12px;">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                </div>
            </div>
        </div>
    </section>

    <div id="admin-login-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="brand-font" style="margin-bottom: 20px;">–í—Ö–æ–¥ –¥–ª—è –∫—É—Ä–∞—Ç–æ—Ä–∞</h3>
            <input type="password" id="admin-pass-input" class="modern-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞">
            <div id="login-error" style="color: #ef4444; font-size: 0.8rem; margin-bottom: 10px; display: none;">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!</div>
            <button class="btn-magic" onclick="tryLogin()">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
            <button class="btn-text" onclick="navigateTo('home')" style="margin-top: 10px; width: 100%; opacity: 0.6;">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <style>
        /* --- AI SHEET STYLES --- */
        .ai-sheet {
            position: fixed;
            bottom: -100%; /* Hidden by default */
            left: 0;
            width: 100%;
            height: 92vh;
            background: #fff;
            z-index: 2000;
            border-radius: 30px 30px 0 0;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.15);
            transition: transform 0.6s cubic-bezier(0.32, 0.72, 0, 1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .ai-sheet.active {
            transform: translateY(-100%);
        }

        .ai-sheet-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(4px);
            z-index: 1999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s;
        }
        .ai-sheet-overlay.active { opacity: 1; pointer-events: all; }

        .ai-sheet-header {
            padding: 15px 20px 25px 20px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            position: relative;
        }

        .ai-drag-handle {
            width: 40px; height: 5px;
            background: #e5e7eb;
            border-radius: 10px;
            margin: 0 auto 15px auto;
        }

        .ai-header-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-avatar {
            width: 45px; height: 45px;
            background: var(--primary-gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: var(--glow);
        }

        .ai-close-btn {
            margin-left: auto;
            background: #f3f4f6;
            border: none;
            width: 30px; height: 30px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* –ß–∞—Ç –∏ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .ai-chat-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #fcfcfd;
        }

        .chat-welcome {
            text-align: center;
            margin-top: 40px;
            color: var(--text-secondary);
        }

        .magic-loader {
            width: 50px; height: 50px;
            border: 3px solid #f3f4f6;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            margin: 0 auto 15px auto;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        .ai-chat-footer {
            padding: 20px;
            background: #fff;
            border-top: 1px solid rgba(0,0,0,0.05);
            padding-bottom: 40px; /* –î–ª—è –∞–π—Ñ–æ–Ω–æ–≤ */
        }

        .ai-input-wrapper {
            background: #f3f4f6;
            border-radius: 20px;
            padding: 10px 15px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        #ai-input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            padding: 10px 0;
            font-family: inherit;
            font-size: 1rem;
            resize: none;
            max-height: 150px;
        }

        #ai-send-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 40px; height: 40px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        /* --- ADMIN PANEL STYLES --- */
        .admin-container { padding-top: 20px; }
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .admin-card {
            background: #fff;
            border-radius: 24px;
            padding: 24px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .admin-card h3 { margin-bottom: 20px; font-size: 1.1rem; }

        .admin-control-item { margin-bottom: 15px; }
        .admin-control-item span {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .btn-logout {
            padding: 8px 16px;
            background: #fee2e2;
            color: #ef4444;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
        }

        /* –ú–æ–¥–∞–ª–∫–∞ –≤—Ö–æ–¥–∞ */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            z-index: 3000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            width: 90%;
            max-width: 400px;
            background: #fff;
            padding: 40px;
            border-radius: 30px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in-element {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
        }
        .fade-in-element.visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
    <script>
        // --- –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ---
        const AppState = {
            currentSection: 'home',
            isAdmin: false,
            chatHistory: JSON.parse(localStorage.getItem('studybox_chat')) || [],
            config: JSON.parse(localStorage.getItem('studybox_config')) || {
                heroTitle: "–£–º–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü",
                gradient: "linear-gradient(135deg, #7F00FF 0%, #E100FF 100%)"
            }
        };

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
        window.addEventListener('DOMContentLoaded', () => {
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∫–∏
            applyConfig();
            
            // –°–∫—Ä—ã–≤–∞–µ–º Splash —á–µ—Ä–µ–∑ 2.5 —Å–µ–∫
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                splash.style.opacity = '0';
                setTimeout(() => {
                    splash.style.display = 'none';
                    checkScroll(); // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ—è–≤–ª–µ–Ω–∏—è
                }, 800);
            }, 2500);
        });

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function navigateTo(sectionId) {
            if (sectionId === 'admin' && !AppState.isAdmin) {
                document.getElementById('admin-login-modal').style.display = 'flex';
                return;
            }

            // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä–æ–µ
            document.querySelectorAll('section').forEach(s => {
                s.classList.remove('active', 'visible');
            });
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('current'));

            // –í–∫–ª—é—á–∞–µ–º –Ω–æ–≤–æ–µ
            const target = document.getElementById(sectionId);
            target.classList.add('active');
            setTimeout(() => target.classList.add('visible'), 50);
            
            AppState.currentSection = sectionId;
            toggleMenu(false); // –ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ
            window.scrollTo(0,0);
        }

        function toggleMenu(force) {
            const nav = document.getElementById('nav-overlay');
            const burger = document.querySelector('.burger-btn');
            const isActive = force !== undefined ? force : !nav.classList.contains('active');
            
            nav.classList.toggle('active', isActive);
            burger.classList.toggle('active', isActive);
        }

        // --- –ú–ê–ì–ò–ß–ï–°–ö–ò–ô AI –ß–ê–¢ ---
        function openAI() {
            toggleMenu(false);
            const sheet = document.getElementById('ai-sheet');
            const overlay = document.getElementById('ai-overlay');
            
            sheet.classList.add('active');
            overlay.classList.add('active');
            
            // "–ú–∞–≥–∏—á–µ—Å–∫–∞—è" –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
            const body = document.getElementById('ai-chat-body');
            if (AppState.chatHistory.length === 0) {
                setTimeout(() => {
                    body.innerHTML = `
                        <div class="ai-msg" style="background:#f3f4f6; padding:15px; border-radius:18px; align-self:flex-start; max-width:80%;">
                            –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π AI-–ø–æ–º–æ—â–Ω–∏–∫ StudyBox. –ú–æ–≥—É –æ–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–æ—Ä–µ–º—É, —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–±–æ–ª—Ç–∞—Ç—å. –û —á–µ–º –¥—É–º–∞–µ—à—å?
                        </div>
                    `;
                }, 1500);
            } else {
                renderHistory();
            }
        }

        function closeAI() {
            document.getElementById('ai-sheet').classList.remove('active');
            document.getElementById('ai-overlay').classList.remove('active');
        }

        function sendAIMessage() {
            const input = document.getElementById('ai-input');
            const text = input.value.trim();
            if (!text) return;

            const body = document.getElementById('ai-chat-body');
            
            // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userDiv = document.createElement('div');
            userDiv.style = "background: var(--primary-gradient); color:white; padding:15px; border-radius:18px; align-self:flex-end; max-width:80%;";
            userDiv.textContent = text;
            body.appendChild(userDiv);
            
            input.value = '';
            body.scrollTop = body.scrollHeight;

            // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏
            setTimeout(() => {
                const aiDiv = document.createElement('div');
                aiDiv.style = "background:#f3f4f6; padding:15px; border-radius:18px; align-self:flex-start; max-width:80%; border-left: 4px solid var(--primary-color);";
                aiDiv.innerHTML = "<b>StudyBox AI:</b> –•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å! –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç–æ, –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –±–∞–∑–æ–≤—É—é –ª–æ–≥–∏–∫—É... (–∑–¥–µ—Å—å –±—É–¥–µ—Ç API –æ—Ç–≤–µ—Ç)";
                body.appendChild(aiDiv);
                body.scrollTop = body.scrollHeight;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                AppState.chatHistory.push({role: 'user', text: text}, {role: 'ai', text: aiDiv.innerHTML});
                localStorage.setItem('studybox_chat', JSON.stringify(AppState.chatHistory));
            }, 1000);
        }

        // --- –õ–û–ì–ò–ö–ê –ê–î–ú–ò–ù–ö–ò (–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï ACCESS DENIED) ---
        function tryLogin() {
            const pass = document.getElementById('admin-pass-input').value;
            const error = document.getElementById('login-error');
            
            // –ü–∞—Ä–æ–ª—å: admin2026 (–º–æ–∂–µ—à—å –ø–æ–º–µ–Ω—è—Ç—å –∑–¥–µ—Å—å)
            if (pass === 'admin2026') {
                AppState.isAdmin = true;
                document.getElementById('admin-login-modal').style.display = 'none';
                navigateTo('admin');
                error.style.display = 'none';
            } else {
                error.style.display = 'block';
                error.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞!";
                // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å—Ç—Ä—è—Å–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                const modal = document.querySelector('.modal-content');
                modal.style.animation = 'shake 0.4s';
                setTimeout(() => modal.style.animation = '', 400);
            }
        }

        function logout() {
            AppState.isAdmin = false;
            navigateTo('home');
        }

        function saveConfig() {
            const newTitle = document.getElementById('conf-hero-title').value;
            const newGrad = document.getElementById('conf-gradient').value;
            
            AppState.config.heroTitle = newTitle;
            AppState.config.gradient = newGrad;
            
            localStorage.setItem('studybox_config', JSON.stringify(AppState.config));
            applyConfig();
            alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!");
        }

        function applyConfig() {
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            document.querySelector('.hero-title').innerHTML = AppState.config.heroTitle.replace("–±–µ–∑ –≥—Ä–∞–Ω–∏—Ü", `<span class="text-gradient">–±–µ–∑ –≥—Ä–∞–Ω–∏—Ü</span>`);
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            document.documentElement.style.setProperty('--primary-gradient', AppState.config.gradient);
        }

        // --- –°–ö–†–û–õ–õ –≠–§–§–ï–ö–¢–´ ---
        window.addEventListener('scroll', checkScroll);
        function checkScroll() {
            const header = document.getElementById('app-header');
            if (window.scrollY > 50) header.classList.add('scrolled');
            else header.classList.remove('scrolled');

            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
            const elements = document.querySelectorAll('.fade-in-element');
            elements.forEach(el => {
                const rect = el.getBoundingClientRect();
                if (rect.top < window.innerHeight - 50) {
                    el.classList.add('visible');
                }
            });
        }

        // --- –í–ò–ó–ê–†–î (–†–ï–®–ï–ù–ò–Ø) ---
        function wizNext(step) {
            const fill = document.getElementById('progress-fill');
            fill.style.width = (step * 33.3) + '%';
            document.getElementById('node-' + (step + 1)).classList.add('active');
            
            if(step === 1) {
                const val = document.getElementById('select-class').value;
                document.getElementById('wizard-dynamic-container').innerHTML = `
                    <h3 style="margin-bottom: 20px;">–í—ã–±—Ä–∞–Ω ${val} –∫–ª–∞—Å—Å. –ö–∞–∫–æ–π –ø—Ä–µ–¥–º–µ—Ç?</h3>
                    <select class="modern-select" id="select-subject" onchange="wizNext(2)">
                        <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                        <option value="math">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
                        <option value="phys">–§–∏–∑–∏–∫–∞</option>
                        <option value="chem">–•–∏–º–∏—è</option>
                    </select>
                `;
            }
        }
    </script>

    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</body>
</html>
